
(function(c){var a,b=c.tablesorter;b.addWidget({id:"pager",priority:55,options:{pager_output:"{startRow} to {endRow} of {totalRows} rows",pager_updateArrows:true,pager_startPage:0,pager_pageReset:0,pager_size:10,pager_savePages:true,pager_storageKey:"tablesorter-pager",pager_fixedHeight:false,pager_countChildRows:false,pager_removeRows:false,pager_ajaxUrl:null,pager_customAjaxUrl:function(e,d){return d},pager_ajaxObject:{dataType:"json"},pager_processAjaxOnInit:true,pager_ajaxProcessing:function(d){return[0,[],null]},pager_css:{container:"tablesorter-pager",errorRow:"tablesorter-errorRow",disabled:"disabled"},pager_selectors:{container:".pager",first:".first",prev:".prev",next:".next",last:".last",gotoPage:".gotoPage",pageDisplay:".pagedisplay",pageSize:".pagesize"}},init:function(d){a.init(d)},format:function(d,e){if(!(e.pager&&e.pager.initialized)){return a.initComplete(d,e)}a.moveToPage(d,e.pager,false)},remove:function(d,e){a.destroyPager(d,e)}});a=b.pager={init:function(g){if(g.hasInitialized&&g.config.pager.initialized){return}var d,i=g.config,f=i.widgetOptions,e=f.pager_selectors,h=i.pager=c.extend({totalPages:0,filteredRows:0,filteredPages:0,currentFilters:[],page:f.pager_startPage,startRow:0,endRow:0,ajaxCounter:0,$size:null,last:{}},i.pager);if(h.isInitializing){return}h.isInitializing=true;if(i.debug){b.log("Pager initializing")}h.size=c.data(g,"pagerLastSize")||f.pager_size;h.$container=c(e.container).addClass(f.pager_css.container).show();h.$goto=h.$container.find(e.gotoPage);h.$size=h.$container.find(e.pageSize);h.totalRows=i.$tbodies.eq(0).children("tr").not(i.widgetOptions.pager_countChildRows?"":"."+i.cssChildRow).length;h.oldAjaxSuccess=h.oldAjaxSuccess||f.pager_ajaxObject.success;i.appender=a.appender;if(b.filter&&c.inArray("filter",i.widgets)>=0){h.currentFilters=i.$table.data("lastSearch")||b.filter.setDefaults(g,i,f)||[];b.setFilters(g,h.currentFilters,false)}if(f.pager_savePages&&b.storage){d=b.storage(g,f.pager_storageKey)||{};h.page=isNaN(d.page)?h.page:d.page;h.size=(isNaN(d.size)?h.size:d.size)||10;c.data(g,"pagerLastSize",h.size)}h.regexRows=new RegExp("("+(f.filter_filteredRow||"filtered")+"|"+i.selectorRemove.replace(/^(\w+\.)/g,"")+"|"+i.cssChildRow+")");h.initialized=false;i.$table.trigger("pagerBeforeInitialized",i);a.enablePager(g,i,false);if(typeof(f.pager_ajaxUrl)==="string"){h.ajax=true;f.filter_serversideFiltering=true;i.serverSideSorting=true;a.moveToPage(g,h)}else{h.ajax=false;i.$table.trigger("appendCache",[{},true]);a.hideRowsSetup(g,i)}},initComplete:function(d,f){var e=f.pager;a.changeHeight(d,f);a.bindEvents(d,f);a.setPageSize(d,0,f);e.initialized=true;e.isInitializing=false;f.$table.trigger("pagerInitialized",f);a.updatePageDisplay(d,f)},bindEvents:function(g,j){var d,h,i=j.pager,f=j.widgetOptions,e=f.pager_selectors;j.$table.unbind("filterStart filterEnd sortEnd disable enable destroy update updateRows updateAll addRows pageSize ".split(" ").join(".pager ")).bind("filterStart.pager",function(l,k){i.currentFilters=k;if(f.pager_pageReset!==false&&(j.lastCombinedFilter||"")!==(k||[]).join("")){i.page=f.pager_pageReset}}).bind("filterEnd.pager sortEnd.pager",function(){if(i.initialized){if(j.delayInit&&j.rowsCopy&&j.rowsCopy.length===0){a.updateCache(g)}a.updatePageDisplay(g,j,false);a.moveToPage(g,i,false);a.fixHeight(g,j)}}).bind("disable.pager",function(k){k.stopPropagation();a.showAllRows(g,j)}).on("enable.pager",function(k){k.stopPropagation();a.enablePager(g,j,true)}).on("destroy.pager",function(k){k.stopPropagation();a.destroyPager(g,j)}).on("update updateRows updateAll addRows ".split(" ").join(".pager "),function(l){l.stopPropagation();a.fixHeight(g,j);var k=j.$tbodies.eq(0).children("tr");i.totalRows=k.length-(j.widgetOptions.pager_countChildRows?0:k.filter("."+j.cssChildRow).length);i.totalPages=Math.ceil(i.totalRows/i.size);a.updatePageDisplay(g,j);a.hideRows(g,j);j.$table.trigger("applyWidgets")}).on("pageSize.pager",function(l,k){l.stopPropagation();a.setPageSize(g,parseInt(k,10)||10,j);a.hideRows(g,j);a.updatePageDisplay(g,j,false);if(i.$size.length){i.$size.val(i.size)}}).on("pageSet.pager",function(l,k){l.stopPropagation();i.page=(parseInt(k,10)||1)-1;if(i.$goto.length){i.$goto.val(j.size)}a.moveToPage(g,i,true);a.updatePageDisplay(g,j,false)});d=[e.first,e.prev,e.next,e.last];h=["moveToFirstPage","moveToPrevPage","moveToNextPage","moveToLastPage"];i.$container.find(d.join(",")).attr("tabindex",0).unbind("click.pager").bind("click.pager",function(o){o.stopPropagation();var m,n=c(this),k=d.length;if(!n.hasClass(f.pager_css.disabled)){for(m=0;m<k;m++){if(n.is(d[m])){a[h[m]](g,i);break}}}});if(i.$goto.length){i.$goto.unbind("change").bind("change",function(){i.page=c(this).val()-1;a.moveToPage(g,i,true);a.updatePageDisplay(g,j,false)})}if(i.$size.length){i.$size.find("option").removeAttr("selected");i.$size.unbind("change.pager").bind("change.pager",function(){i.$size.val(c(this).val());if(!c(this).hasClass(f.pager_css.disabled)){a.setPageSize(g,parseInt(c(this).val(),10),j);a.changeHeight(g,j)}return false})}},pagerArrows:function(h,f){var d=h.pager,e=!!f,g=e||d.page===0,i=Math.min(d.totalPages,d.filteredPages),k=e||d.page===i-1||i===0,j=h.widgetOptions,l=j.pager_selectors;if(j.pager_updateArrows){d.$container.find(l.first+","+l.prev).toggleClass(j.pager_css.disabled,g).attr("aria-disabled",g);d.$container.find(l.next+","+l.last).toggleClass(j.pager_css.disabled,k).attr("aria-disabled",k)}},updatePageDisplay:function(q,l,e){var g,j,r,u,n,m=l.widgetOptions,d=l.pager,h=l.$table.hasClass("hasFilters"),o=[],k=d.size||10;o=[m&&m.filter_filteredRow||"filtered",l.selectorRemove.replace(/^(\w+\.)/g,"")];if(m.pager_countChildRows){o.push(l.cssChildRow)}n=new RegExp("("+o.join("|")+")");d.$size.add(d.$goto).removeClass(m.pager_css.disabled).removeAttr("disabled").attr("aria-disabled","false");if(h&&!m.pager_ajaxUrl){if(c.isEmptyObject(l.cache)){d.filteredRows=d.totalRows=l.$tbodies.eq(0).children("tr").not(l.widgetOptions.pager_countChildRows?"":"."+l.cssChildRow).length}else{d.filteredRows=0;c.each(l.cache[0].normalized,function(f,p){d.filteredRows+=d.regexRows.test(p[l.columns].$row[0].className)?0:1})}}else{if(!h){d.filteredRows=d.totalRows}}d.totalPages=Math.ceil(d.totalRows/k);l.totalRows=d.totalRows;l.filteredRows=d.filteredRows;d.filteredPages=Math.ceil(d.filteredRows/k)||0;if(Math.min(d.totalPages,d.filteredPages)>=0){o=(d.size*d.page>d.filteredRows);d.startRow=(o)?1:(d.filteredRows===0?0:d.size*d.page+1);d.page=(o)?0:d.page;d.endRow=Math.min(d.filteredRows,d.totalRows,d.size*(d.page+1));u=d.$container.find(m.pager_selectors.pageDisplay);r=(d.ajaxData&&d.ajaxData.output?d.ajaxData.output||m.pager_output:m.pager_output).replace(/\{page([\-+]\d+)?\}/gi,function(f,i){return d.totalPages?d.page+(i?parseInt(i,10):1):0}).replace(/\{\w+(\s*:\s*\w+)?\}/gi,function(p){var i,s,v=p.replace(/[{}\s]/g,""),f=v.split(":"),t=d.ajaxData,w=/(rows?|pages?)$/i.test(v)?0:"";if(/(startRow|page)/.test(f[0])&&f[1]==="input"){i=(""+(f[0]==="page"?d.totalPages:d.totalRows)).length;s=f[0]==="page"?d.page+1:d.startRow;return'<input type="text" class="ts-'+f[0]+'" style="max-width:'+i+'em" value="'+s+'"/>'}return f.length>1&&t&&t[f[0]]?t[f[0]][f[1]]:d[v]||(t?t[v]:w)||w});if(u.length){u[(u[0].tagName==="INPUT")?"val":"html"](r);if(d.$goto.length){o="";j=Math.min(d.totalPages,d.filteredPages);for(g=1;g<=j;g++){o+="<option>"+g+"</option>"}d.$goto.html(o).val(d.page+1)}u.find(".ts-startRow, .ts-page").unbind("change").bind("change",function(){var f=c(this).val(),i=c(this).hasClass("ts-startRow")?Math.floor(f/d.size)+1:f;l.$table.trigger("pageSet.pager",[i])})}}a.pagerArrows(l);if(d.initialized&&e!==false){l.$table.trigger("pagerComplete",l);if(m.pager_savePages&&b.storage){b.storage(q,m.pager_storageKey,{page:d.page,size:d.size})}}},fixHeight:function(i,l){var k,f,j=l.pager,e=l.widgetOptions,g=l.$tbodies.eq(0);if(e.pager_fixedHeight){g.find("tr.pagerSavedHeightSpacer").remove();f=c.data(i,"pagerSavedHeight");if(f){k=f-g.height();if(k>5&&c.data(i,"pagerLastSize")===j.size&&g.children("tr:visible").length<j.size){g.append('<tr class="pagerSavedHeightSpacer '+e.pager_selectors.remove.replace(/^(\w+\.)/g,"")+'" style="height:'+k+'px;"></tr>')}}}},changeHeight:function(e,f){var d=f.$tbodies.eq(0);d.find("tr.pagerSavedHeightSpacer").remove();c.data(e,"pagerSavedHeight",d.height());a.fixHeight(e,f);c.data(e,"pagerLastSize",f.pager.size)},hideRows:function(t,q){if(!q.widgetOptions.pager_ajaxUrl){var k,m=0,d=q.pager,r=q.widgetOptions,v=q.$tbodies.eq(0).children("tr"),g=v.length,u=(d.page*d.size),o=u+d.size,n=r&&r.filter_filteredRow||"filtered",h=0;for(k=0;k<g;k++){if(!v[k].className.match(n)){if(h===u&&v[k].className.match(q.cssChildRow)){v[k].style.display="none"}else{v[k].style.display=(h>=u&&h<o)?"":"none";h+=v[k].className.match(q.cssChildRow+"|"+q.selectorRemove.replace(/^(\w+\.)/g,""))&&!r.pager_countChildRows?0:1;if(h===o&&v[k].style.display!=="none"&&v[k].className.match(b.css.cssHasChild)){m=k}}}}if(m>0&&v[m].className.match(b.css.cssHasChild)){while(++m<g&&v[m].className.match(q.cssChildRow)){v[m].style.display=""}}}},hideRowsSetup:function(d,f){var e=f.pager;e.size=parseInt(e.$size.val(),10)||e.size;c.data(d,"pagerLastSize",e.size);a.pagerArrows(f);if(!f.widgetOptions.pager_removeRows){a.hideRows(d,f);f.$table.on("sortEnd.pager filterEnd.pager",function(){a.hideRows(d,f)})}},renderAjax:function(C,y,B,k,m){var r=B.pager,g=B.widgetOptions;if(c.isFunction(g.pager_ajaxProcessing)){var w,u,q,o,e,z,h,A,s,D,x=B.$table,v="",n=g.pager_ajaxProcessing(C,y,k)||[0,[]],f=x.find("thead th").length;b.showError(y);if(m){if(B.debug){b.log("Ajax Error",k,m)}b.showError(y,m.message+" ("+k.status+")");B.$tbodies.eq(0).children("tr").detach();r.totalRows=0}else{if(!c.isArray(n)){r.ajaxData=n;B.totalRows=r.totalRows=n.total;B.filteredRows=r.filteredRows=typeof n.filteredRows!=="undefined"?n.filteredRows:n.total;h=n.headers;A=n.rows}else{q=isNaN(n[0])&&!isNaN(n[1]);D=n[q?1:0];r.totalRows=isNaN(D)?r.totalRows||0:D;B.totalRows=B.filteredRows=r.filteredRows=r.totalRows;A=r.totalRows===0?[""]:n[q?0:1]||[];h=n[2]}s=A&&A.length;if(A instanceof jQuery){if(g.pager_processAjaxOnInit){B.$tbodies.eq(0).children("tr").detach();B.$tbodies.eq(0).append(A)}}else{if(s){for(w=0;w<s;w++){v+="<tr>";for(u=0;u<A[w].length;u++){v+=/^\s*<td/.test(A[w][u])?c.trim(A[w][u]):"<td>"+A[w][u]+"</td>"}v+="</tr>"}if(g.pager_processAjaxOnInit){B.$tbodies.eq(0).html(v)}}}g.pager_processAjaxOnInit=true;if(h&&h.length===f){o=x.hasClass("hasStickyHeaders");z=o?g.$sticky.children("thead:first").children("tr").children():"";e=x.find("tfoot tr:first").children();B.$headers.filter("th").each(function(d){var l=c(this),i;if(l.find("."+b.css.icon).length){i=l.find("."+b.css.icon).clone(true);l.find(".tablesorter-header-inner").html(h[d]).append(i);if(o&&z.length){i=z.eq(d).find("."+b.css.icon).clone(true);z.eq(d).find(".tablesorter-header-inner").html(h[d]).append(i)}}else{l.find(".tablesorter-header-inner").html(h[d]);if(o&&z.length){z.eq(d).find(".tablesorter-header-inner").html(h[d])}}e.eq(d).html(h[d])})}}if(B.showProcessing){b.isProcessing(y)}r.totalPages=Math.ceil(r.totalRows/(r.size||10));r.last.totalRows=r.totalRows;r.last.currentFilters=r.currentFilters;r.last.sortList=(B.sortList||[]).join(",");a.updatePageDisplay(y,B);a.fixHeight(y,B);x.trigger("updateCache",[function(){if(r.initialized){setTimeout(function(){x.trigger("applyWidgets").trigger("pagerChange",r)},0)}}])}if(!r.initialized){B.$table.trigger("applyWidgets")}},getAjax:function(g,j){var d,e=a.getAjaxUrl(g,j),i=c(document),f=j.widgetOptions,h=j.pager;if(e!==""){if(j.showProcessing){b.isProcessing(g,true)}i.on("ajaxError.pager",function(m,n,l,k){a.renderAjax(null,g,j,n,k);i.unbind("ajaxError.pager")});d=++h.ajaxCounter;f.pager_ajaxObject.url=e;f.pager_ajaxObject.success=function(l,k,m){if(d<h.ajaxCounter){return}a.renderAjax(l,g,j,m);i.unbind("ajaxError.pager");if(typeof h.oldAjaxSuccess==="function"){h.oldAjaxSuccess(l)}};if(j.debug){b.log("ajax initialized",f.pager_ajaxObject)}c.ajax(f.pager_ajaxObject)}},getAjaxUrl:function(m,j){var e=j.pager,k=j.widgetOptions,d=(k.pager_ajaxUrl)?k.pager_ajaxUrl.replace(/\{page([\-+]\d+)?\}/,function(o,p){return e.page+(p?parseInt(p,10):0)}).replace(/\{size\}/g,e.size):"",g=j.sortList,l=e.currentFilters||c(m).data("lastSearch")||[],i=d.match(/\{\s*sort(?:List)?\s*:\s*(\w*)\s*\}/),f=d.match(/\{\s*filter(?:List)?\s*:\s*(\w*)\s*\}/),h=[];if(i){i=i[1];c.each(g,function(o,n){h.push(i+"["+n[0]+"]="+n[1])});d=d.replace(/\{\s*sort(?:List)?\s*:\s*(\w*)\s*\}/g,h.length?h.join("&"):i);h=[]}if(f){f=f[1];c.each(l,function(o,n){if(n){h.push(f+"["+o+"]="+encodeURIComponent(n))}});d=d.replace(/\{\s*filter(?:List)?\s*:\s*(\w*)\s*\}/g,h.length?h.join("&"):f);e.currentFilters=l}if(c.isFunction(k.pager_customAjaxUrl)){d=k.pager_customAjaxUrl(m,d)}if(j.debug){b.log("Pager ajax url: "+d)}return d},renderTable:function(r,u){var g,k,j,o,n=r.config,d=n.pager,q=n.widgetOptions,i=n.$table.hasClass("hasFilters"),h=u&&u.length||0,t=(d.page*d.size),m=d.size;if(h<1){if(n.debug){b.log("Pager: no rows for pager to render")}return}if(d.page>=d.totalPages){return a.moveToLastPage(r,d)}d.isDisabled=false;if(d.initialized){n.$table.trigger("pagerChange",n)}if(!q.pager_removeRows){a.hideRows(r,n)}else{b.clearTableBody(r);g=b.processTbody(r,n.$tbodies.eq(0),true);k=i?0:t;j=i?0:t;o=0;while(o<m&&k<u.length){if(!i||!/filtered/.test(u[k][0].className)){j++;if(j>t&&o<=m){o++;g.append(u[k])}}k++}b.processTbody(r,g,false)}a.updatePageDisplay(r,n);if(!d.isDisabled){a.fixHeight(r,n)}q.pager_startPage=d.page;q.pager_size=d.size;n.$table.trigger("applyWidgets");if(r.isUpdating){n.$table.trigger("updateComplete")}},showAllRows:function(e,g){var f=g.pager,d=g.widgetOptions;if(f.ajax){a.pagerArrows(g,true)}else{f.isDisabled=true;c.data(e,"pagerLastPage",f.page);c.data(e,"pagerLastSize",f.size);f.page=0;f.size=f.totalRows;f.totalPages=1;g.$table.addClass("pagerDisabled").removeAttr("aria-describedby").find("tr.pagerSavedHeightSpacer").remove();a.renderTable(e,g.rowsCopy);if(g.debug){b.log("pager disabled")}}f.$size.add(f.$goto).each(function(){c(this).attr("aria-disabled","true").addClass(d.pager_css.disabled)[0].disabled=true})},updateCache:function(d){var f=d.config,e=f.pager;f.$table.trigger("updateCache",[function(){if(!c.isEmptyObject(d.config.cache)){var g,h=[],j=d.config.cache[0].normalized;e.totalRows=j.length;for(g=0;g<e.totalRows;g++){h.push(j[g][f.columns].$row)}f.rowsCopy=h;a.moveToPage(d,e,true);e.last.currentFilters=[" "]}}])},moveToPage:function(f,g,e){if(g.isDisabled){return}if(e!==false&&g.initialized&&c.isEmptyObject(f.config.cache)){return a.updateCache(f)}var i=f.config,d=g.last,h=Math.min(g.totalPages,g.filteredPages);if(g.page<0){g.page=0}if(g.page>(h-1)&&h!==0){g.page=h-1}d.currentFilters=(d.currentFilters||[]).join("")===""?[]:d.currentFilters;g.currentFilters=(g.currentFilters||[]).join("")===""?[]:g.currentFilters;if(d.page===g.page&&d.size===g.size&&d.totalRows===g.totalRows&&(d.currentFilters||[]).join(",")===(g.currentFilters||[]).join(",")&&d.sortList===(i.sortList||[]).join(",")){return}if(i.debug){b.log("Pager changing to page "+g.page)}g.last={page:g.page,size:g.size,sortList:(i.sortList||[]).join(","),totalRows:g.totalRows,currentFilters:g.currentFilters||[]};if(g.ajax){a.getAjax(f,i)}else{if(!g.ajax){a.renderTable(f,i.rowsCopy)}}c.data(f,"pagerLastPage",g.page);if(g.initialized&&e!==false){i.$table.trigger("pageMoved",i);if(!g.ajax&&f.isUpdating){i.$table.trigger("updateComplete")}}},setPageSize:function(e,d,g){var f=g.pager;f.size=d||f.size||10;f.$size.val(f.size);c.data(e,"pagerLastPage",f.page);c.data(e,"pagerLastSize",f.size);f.totalPages=Math.ceil(f.totalRows/f.size);f.filteredPages=Math.ceil(f.filteredRows/f.size);a.moveToPage(e,f,true)},moveToFirstPage:function(d,e){e.page=0;a.moveToPage(d,e,true)},moveToLastPage:function(d,e){e.page=(Math.min(e.totalPages,e.filteredPages)-1);a.moveToPage(d,e,true)},moveToNextPage:function(d,e){e.page++;if(e.page>=(Math.min(e.totalPages,e.filteredPages)-1)){e.page=(Math.min(e.totalPages,e.filteredPages)-1)}a.moveToPage(d,e,true)},moveToPrevPage:function(d,e){e.page--;if(e.page<=0){e.page=0}a.moveToPage(d,e,true)},destroyPager:function(d,f){var e=f.pager;a.showAllRows(d,f);e.$container.hide();f.appender=null;e.initialized=false;delete d.config.rowsCopy;f.$table.unbind("destroy.pager sortEnd.pager filterEnd.pager enable.pager disable.pager");if(b.storage){b.storage(d,f.widgetOptions.pager_storageKey,"")}},enablePager:function(e,h,d){var g,f=h.pager;f.isDisabled=false;f.page=c.data(e,"pagerLastPage")||f.page||0;f.size=c.data(e,"pagerLastSize")||parseInt(f.$size.find("option[selected]").val(),10)||f.size||10;f.$size.val(f.size);f.totalPages=Math.ceil(Math.min(f.totalRows,f.filteredRows)/f.size);h.$table.removeClass("pagerDisabled");if(e.id){g=e.id+"_pager_info";f.$container.find(h.widgetOptions.pager_selectors.pageDisplay).attr("id",g);h.$table.attr("aria-describedby",g)}if(d){h.$table.trigger("updateRows");a.setPageSize(e,f.size,h);a.hideRowsSetup(e,h);a.fixHeight(e,h);if(h.debug){b.log("pager enabled")}}},appender:function(e,f){var h=e.config,d=h.widgetOptions,g=h.pager;if(!g.ajax){h.rowsCopy=f;g.totalRows=h.widgetOptions.pager_countChildRows?h.$tbodies.eq(0).children("tr").length:f.length;g.size=c.data(e,"pagerLastSize")||g.size||d.pager_size||10;g.totalPages=Math.ceil(g.totalRows/g.size);a.moveToPage(e,g);a.updatePageDisplay(e,h,false)}else{a.moveToPage(e,g,true)}}};b.showError=function(e,d){c(e).each(function(){var f,h=this.config,g=h.pager&&h.pager.cssErrorRow||h.widgetOptions.pager_css&&h.widgetOptions.pager_css.errorRow||"tablesorter-errorRow";if(h){if(typeof d==="undefined"){h.$table.find("thead").find(h.selectorRemove).remove()}else{f=(/tr\>/.test(d)?c(d):c('<tr><td colspan="'+h.columns+'">'+d+"</td></tr>")).click(function(){c(this).remove()}).appendTo(h.$table.find("thead:first")).addClass(g+" "+h.selectorRemove.replace(/^(\w+\.)/g,"")).attr({role:"alert","aria-live":"assertive"})}}})}})(jQuery);